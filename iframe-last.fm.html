---
layout: iframe
---
<footer>*this might show non music, last.fm is bugged and will do this because it is connected to my youtube</footer>
<div id="lastfm-info">Loading...</div>

<script>
  function unescapeHTML(str) {
    const div = document.createElement('div');
    div.innerHTML = str;
    return div.textContent;
  }

  async function fetchLastFM() {
    const container = document.getElementById('lastfm-info');
    if (!container) return;

    try {
      const response = await fetch('https://linuxfandudeguyapi.netlify.app/.netlify/functions/lastfm');
      if (!response.ok) throw new Error('Network response was not ok');

      const data = await response.json();
      const track = data.recenttracks.track[0] || {};

      const artistName = track.artist ? track.artist['#text'] : 'N/A';
      const trackName = track.name || 'N/A';
      const trackUrl = track.url || '#';
      const artistUrl = trackUrl.split('/_/')[0] || '#'; // <-- artist URL
      const albumName = track.album ? track.album['#text'] : 'N/A';
      const imageUrl = (track.image || []).find(img => img.size === 'medium')?.['#text'] || '';

      // Pre-escaped HTML
      let html = '';
      html += '&lt;p&gt;&lt;strong&gt;Artist:&lt;/strong&gt; &lt;a href=&quot;' + artistUrl + '&quot; target=&quot;_blank&quot;&gt;' + artistName + '&lt;/a&gt;&lt;/p&gt;';
      html += '&lt;p&gt;&lt;strong&gt;Track:&lt;/strong&gt; &lt;a href=&quot;' + trackUrl + '&quot; target=&quot;_blank&quot;&gt;' + trackName + '&lt;/a&gt;&lt;/p&gt;';
      html += '&lt;p&gt;&lt;strong&gt;Album:&lt;/strong&gt; ' + albumName + '&lt;/p&gt;';
      if (imageUrl) {
        html += '&lt;img src=&quot;' + imageUrl + '&quot; alt=&quot;' + trackName + '&quot; /&gt;';
      }

      container.innerHTML = unescapeHTML(html);

    } catch (err) {
      container.innerHTML = unescapeHTML('&lt;p style=&quot;color:red;&quot;&gt;Error: ' + err.message + '&lt;/p&gt;');
      console.error(err);
    }
  }

  fetchLastFM();
  setInterval(fetchLastFM, 5000);
</script>

